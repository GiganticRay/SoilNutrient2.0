<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="Script/jquery-2.2.4.min.js" type="text/javascript"></script>
    <script src="Script/JsonExportExcel.min.js" type="text/javascript"></script>
    <!--sweetalert-->
    <!-- <script src="https://cdn.bootcss.com/sweetalert/1.1.3/sweetalert-dev.min.js"></script>-->
    <script src="Script/sweetalert/sweetalert-dev.min.js" type="text/javascript"></script>
</head>
<body>
    
<script type="text/javascript">
    $(function() {

        var postData = $("#MultileSearchForm").serializeArray();
        $.getJSON("../Ashx/ProcessJsonExportExcel.ashx", postData, function (data) {
            if (data.length == 0) {
                swal({
                    title: "所选地区无样本点！",
                    type: "error",
                    timer: 1500
                });
            } else {

                //横轴的名称
                var columnName = [];
                //数据点
                var columnDataN = [];
                var columnDataP = [];
                var columnDataK = [];
                var columnDataHydrolyticN = [];
                var columnDataQuickP = [];
                var columnDataQUicK = [];
                var columnDataOrganicMatter = [];
                var columnDataPH = [];

                for (var i = 0; i < data.length; i++) {
                    columnName[i] = data[i].sampleName;
                    columnDataN[i] = data[i].N;
                    columnDataP[i] = data[i].P;
                    columnDataK[i] = data[i].K;
                    columnDataHydrolyticN[i] = data[i].HydrolyticN;
                    columnDataQuickP[i] = data[i].QuickP;
                    columnDataQUicK[i] = data[i].QUicK;
                    columnDataOrganicMatter[i] = data[i].OrganicMatter;
                    columnDataPH[i] = data[i].PH;
                }

                var option = {};

                option.fileName = 'excel';
                option.datas = [
                    {
                        //把返回的序列化信息给sheetData
                        sheetData: data,
                        sheetName: 'sheet',
                        sheetFilter: ['FarmInfo', 'CropsMegCity', 'CropsMegCounty', 'CropsMegTown', 'CropsMegVillage', 'CropsMegSampleName', 'CropsMegLon', 'CropsMegLat', 'CropsMegNameOfHouseholder', 'CropsMegPhoneNumber', 'CropsMegIrrigationConditions', 'CropsMegAcreage', 'CropsMegFertility', 'CropsMegWeeds', 'SoilNutrientInfo', 'SoilNutrientN', 'SoilNutrientP', 'SoilNutrientK', 'SoilNutrientHydrolyticN', 'SoilNutrientQuickP', 'SoilNutrientQuickK', 'SoilNutrientOrganicMatter', 'SoilNutrientPh', 'CropData', 'CropsMegCropType', 'CropMegVarieties', 'CropMegYield', 'CropMegUrea', 'CropMegAn', 'CropMegK', 'CropMegOrganicManure', 'CropMegOthers', 'CropMegIrrigationTimes', 'FarmSug', 'MSugCropType', 'MSugVarieties', 'MSugTargetYield', 'MSugUrea', 'MSugAn', 'MSugK', 'MSugOrganicManure', 'MSugOthers', 'MSugIrrigationTimes', 'MSugSowingAmout', 'MSugSowingMethod', 'MSugWeedControl', 'MSugPestControl', 'MSugFieldManagement', 'MSugRemarkers'],
                        sheetHeader: ['农田信息',
                            '市级', '县级', '乡/镇', '村', '采样点名称', '经度', '纬度', '户主姓名', '联系电话', '灌溉条件', '土地面积', '土地肥力', '杂草情况',
                            '土壤养分信息',
                            '氮(mg/kg)', '磷(mg/kg)', '钾(mg/kg)', '水解性氮(mg/kg)', '速效磷(mg/kg)', '速效钾(mg/kg)', '有机质(mg/kg)', 'PH',
                            '作物数据',
                            '作物类型', '品种', '产量(kg/亩)', '尿素(kg/亩)', '二胺(kg/亩)', '钾肥(kg/亩)', '有机肥(kg/亩)', '其他(kg/亩)', '灌溉次数(次)',
                            '农田建议',
                            '作物类型', '品种', '目标常量(kg/亩)', '尿素(kg/亩)', '二胺(kg/亩)', '钾肥(kg/亩)', '有机肥(kg/亩)', '其他(kg/亩)', '灌溉次数(次)', '播种量(kg/亩)', '播种方式', '杂草控制', '病虫害控制', '田间管理', '备注']
                    },
                    {
                        sheetData: [{ one: '一行一列', two: '一行二列' }, { one: '二行一列', two: '二行二列'}]
                    }
                ];
                var toExcel = new ExportJsonExcel(option);
                toExcel.saveExcel();
            }

        });
    });
</script>
</body>

</html>
